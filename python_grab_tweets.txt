from tweepy import OAuthHandler
from tweepy import API
from tweepy import Cursor
import re
import string
consumer_key = "yX7EQ1S4od8pv0lzLnlAUpcox" #twitter app’s API Key
consumer_secret = "uBtxKFJkGhfq1xDDa0ElbZFUpqmy073GNvQZZsnLiEDO32mltY" #twitter app’s API secret Key
access_token = "1227238408139001856-lPEAC4YA0IPiBGxhXRlD4iwMGCft5h" #twitter app’s Access token
access_token_secret = "9b8ZGFOw1ofULafGx0ColB7IkXigImNOvwyvavDYNxxmf" #twitter app’s access token secret

auth = OAuthHandler(consumer_key, consumer_secret)
auth.set_access_token(access_token, access_token_secret)
auth_api = API(auth)

leonie_tweets = auth_api.user_timeline(screen_name = 'LeonieWatson', count = 600, include_rts = False, tweet_mode = 'extended')

final_tweets = [each_tweet.full_text for each_tweet in leonie_tweets]

with open('/dbfs/my_tweets.txt','w') as f:
  for item in final_tweets:
    item = item.lower()
    item = re.sub(r'\d+','',item)
    item = item.translate(str.maketrans("","",string.punctuation))
    f.write("%s\n" % item)

read_tweets = []
with open('/dbfs/my_tweets.txt','r') as f:
  read_tweets.append(f.read())
  for x in read_tweets:
    print(x)